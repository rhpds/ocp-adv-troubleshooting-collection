---
- name: Install the latest version of wget, jq and golang
  ansible.builtin.dnf:
    name:
      - wget
      - jq
      - golang
    state: latest

- name: Download the yq tool
  ansible.builtin.command: "{{ item }}"
  loop:
    - wget https://github.com/mikefarah/yq/releases/download/v4.47.2/yq_linux_amd64
    - sudo mv yq_linux_amd64 /usr/bin/yq
    - chmod +x /usr/bin/yq

- name: Download the omc tool
  ansible.builtin.command: "{{ item }}"
  loop:
    - wget https://github.com/gmeghnag/omc/releases/download/v3.11.2/omc_Linux_x86_64
    - sudo mv omc_Linux_x86_64 /usr/bin/omc
    - chmod +x /usr/bin/omc

- name: Download the koff tool
  ansible.builtin.command: "{{ item }}"
  loop:
    - wget https://github.com/gmeghnag/koff/releases/download/v1.0.1/koff_Linux_x86_64
    - sudo mv koff_Linux_x86_64 /usr/bin/koff
    - chmod +x /usr/bin/koff

- name: Download the oc tool
  ansible.builtin.command: "{{ item }}"
  loop:

    - wget https://mirror.openshift.com/pub/openshift-v4/clients/ocp/latest/openshift-client-linux-4.19.13.tar.gz
    - tar zxvf openshift-client-linux-4.19.13.tar.gz oc
    - sudo mv oc /usr/bin/oc
    - chmod +x /usr/bin/oc

- name: Download the kubectl-dev tool
  ansible.builtin.command: "{{ item }}"
  loop:
    - go install github.com/openshift/cluster-debug-tools/cmd/kubectl-dev_tool@latest
    - sudo cp /home/lab-user/go/bin/kubectl-dev_tool /usr/bin/kubectl-dev_tool
    - sudo chmod +x /usr/bin/kubectl-dev_tool

- name: Download the gron tool
  ansible.builtin.command: "{{ item }}"
  loop:
    - wget https://github.com/tomnomnom/gron/releases/download/v0.7.1/gron-linux-amd64-0.7.1.tgz
    - tar zxvf gron-linux-amd64-0.7.1.tgz
    - sudo mv gron /usr/bin/gron
    - chmod +x /usr/bin/gron

- name: Download the etcd-ocp-diag.py tool
  ansible.builtin.command: "{{ item }}"
  loop:
    - wget https://raw.githubusercontent.com/cptmorgan-rh/etcd-ocp-diag-script/refs/heads/main/etcd-ocp-diag.py
    - sudo mv etcd-ocp-diag.py /usr/bin/etcd-ocp-diag.py
    - chmod +x /usr/bin/etcd-ocp-diag.py

- name: Download the ocp-insights tool
  ansible.builtin.command: "{{ item }}"
  loop:
    - wget https://raw.githubusercontent.com/cptmorgan-rh/ocp_insights/refs/heads/insightsarchive/ocp_insights.sh
    - sudo mv ocp_insights.sh /usr/bin/ocp_insights.sh
    - chmod +x /usr/bin/ocp_insights.sh

# all this other weird stuff that's from the old one that we should translate into normal ansible, as needed

# asset_injector_assets:
#
#   - description: Remove 50-cloud-init.conf, ssh issue
#     type: remove
#     path: /etc/ssh/sshd_config.d/50-cloud-init.conf
#
#   - description: Remove 50-redhat.conf, ssh issue
#     type: remove
#     path: /etc/ssh/sshd_config.d/50-redhat.conf
#
#   - description: Update sshd_config for password auth
#     type: blockinfile
#     path: /etc/ssh/sshd_config
#     state: present
#     marker: "# {mark} Our custom SSH settings via Ansible"
#     block: |
#       # Our custom SSH settings via Ansible
#       ChallengeResponseAuthentication no
#       PasswordAuthentication yes
#       UsePAM yes
#
#   - description: Restart sshd to pick up new password support configuration
#     type: service
#     name: sshd
#     state: restarted
#
#   - description: Download must-gather archive
#     type: http
#     dest: /home/lab-user/rh1-lab16-must-gather.zip
#     src: https://d18h2xbjo1t4w8.cloudfront.net/must_gather_lab/rh1-lab16-must-gather.zip
#     url_username: "{{ s3_rhpds_private_username }}"
#     url_password: "{{ s3_rhpds_private_password }}"
#     owner: lab-user
#     group: users
#     mode: u=rw,g=r,o=r
#
#   - description: Unarchive must-gather file
#     type: unarchive
#     src: /home/lab-user/rh1-lab16-must-gather.zip
#     dest: /home/lab-user
#     remote_src: true
#
#   - description: Change ownership of Module directories
#     type: command
#     cmd: 'chown -R lab-user:users /home/lab-user/'
#
#
